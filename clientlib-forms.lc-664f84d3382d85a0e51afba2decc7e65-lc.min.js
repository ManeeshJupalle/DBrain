$(document).ready(function(){
    	if($(".hidden.productInterestAssignment").attr("data-value") != undefined){
       		 if ($(".hidden.productInterestAssignment").attr("data-value").indexOf("ansys:forms/") > -1) {
                        $('a[href*="/contact-us"]').each(function() {	
                            var appendedParam = $(".hidden.productInterestAssignment").attr("data-value").split("ansys:forms/")[1].split(",")[0];
                            $(this).attr("href", $(this).attr("href") + "?pi=" + appendedParam);
                        });
                    }
        		}                
   		 });
$(document).ready(function() {
    $('.recaptcha').addClass('recaptcha-not-displayed');
    function loadScript(url) {
        let isLoaded = document.querySelectorAll('.recaptcha-script');
        if(isLoaded.length > 0) {
        return;
        }

        let myScript = document.createElement("script");
        myScript.src = url;
        myScript.className = 'recaptcha-script';
        document.body.appendChild(myScript);
    }
    $('form input, form textarea, form select').on("input change focus", function() {
        loadScript('https://www.recaptcha.net/recaptcha/api.js?onload=v3_invisible_onload&render='+$(this).closest("form").find(".recaptcha").attr("data-sitekey"));
        $('.recaptcha').removeClass('recaptcha-not-displayed'); 
    });

    var map = new Map();
    map.set("de-de", "Diese Website ist durch reCAPTCHA geschützt und es gelten die <a href='https://policies.google.com/privacy' target='_blank'>Datenschutzbestimmungen </a> und <a href='https://policies.google.com/terms' target='_blank'> Nutzungsbedingungen </a> von Google.");
	map.set("fr-fr", "Ce site est protégé par reCAPTCHA et <a href='https://policies.google.com/privacy' target='_blank'>les règles de confidentialité</a> et <a href='https://policies.google.com/terms' target='_blank'>les conditions d'utilisation</a> de Google s'appliquent.");
    map.set("it-it", "Questo sito è protetto da reCAPTCHA e si applicano le <a href='https://policies.google.com/privacy' target='_blank'>Norme sulla Privacy</a> e i <a href='https://policies.google.com/terms' target='_blank'>Termini di servizio</a> di Google.");
	map.set("ja-jp", "このサイトはreCAPTCHAで保護されており、Google <a href='https://policies.google.com/privacy' target='_blank'>Privacy Policy</a> and <a href='https://policies.google.com/terms' target='_blank'>Terms of Service</a>が適用されます。");
    map.set("ko-kr", "이 사이트는 reCAPTCHA에 의해 보호되며, 구글 <a href='https://policies.google.com/privacy' target='_blank'>개인정보 보호 정책</a>및 <a href='https://policies.google.com/terms' target='_blank'>서비스 약관</a>이 적용됩니다.");
    map.set("zh-cn", "本网站受reCAPTCHA保护，将适用并受限于Google<a href='https://policies.google.com/privacy' target='_blank'>隐私政策</a>和<a href='https://policies.google.com/terms' target='_blank'>服务条款</a>。");
    map.set("zh-tw", "本網站受 reCAPTCHA 保護，適用 Google <a href='https://policies.google.com/privacy' target='_blank'>隱私權政策</a>和<a href='https://policies.google.com/terms' target='_blank'>服務條款</a>。");
    map.set("en-us", "This site is protected by reCAPTCHA and the Google <a href='https://policies.google.com/privacy' target='_blank'>Privacy Policy</a> and <a href='https://policies.google.com/terms' target='_blank'>Terms of Service</a> apply.");

	 if (window.location.href.indexOf("de-de") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('de-de'));
    }
    else if (window.location.href.indexOf("fr-fr") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('fr-fr'));
    }
    else if (window.location.href.indexOf("it-it") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('it-it'));
    }
    else if (window.location.href.indexOf("ja-jp") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('ja-jp'));
    }
    else if (window.location.href.indexOf("ko-kr") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('ko-kr'));
    }
    else if (window.location.href.indexOf("zh-cn") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('zh-cn'));
    }
    else if (window.location.href.indexOf("zh-tw") > -1)
    {
        var obj=$(".recaptcha").next().html( map.get('zh-tw'));
    }
    else
    {
        var obj=$(".recaptcha").next().html( map.get('en-us'));
    }
    
    $(".recaptcha").next().removeClass("d-none").addClass("d-block");
});

var thecurrentform;
var v3_invisible_onload = function() {
    $('.recaptcha').each(function(index, el) {
        grecaptcha.render(el, {
            'sitekey' : $(el).attr('data-sitekey')
            ,'theme' : $(el).attr('data-theme')
            ,'size' : $(el).attr('data-size')
            ,'tabindex' : $(el).attr('data-tabindex')
            ,'callback' : $(el).attr('data-callback')
            ,'expired-callback' : $(el).attr('data-expired-callback')
            ,'error-callback' : $(el).attr('data-error-callback')
        });
    });
};
function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
}

function createCookie(name, value, days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        var expires = "; expires=" + date.toGMTString();
    }
    else var expires = "";

    var fixedName = '';
    name = fixedName + name;

    document.cookie = name + "=" + value + expires + "; path=/";
}

function eraseCookie(name) {
    createCookie(name, "", -1);
}
﻿$(document).ready(function () {
    if ($("html[lang='fr-FR']").length) {
        $('select option:contains("3D Design Exploration")').html("Exploration de la conception 3D");
        $('select option:contains("Cloud and Platform Services")').html("Services de cloud et de plate-forme");
        $('select option:contains("Electromagnetics")').html("Electromagnétisme");
        $('select option:contains("Fluid Dynamics")').html("Dynamique des fluides");
        $('select option:contains("Materials")').html("Matériaux");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("Logiciels embarqués et Sécurité");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("Puissance, performance et fiabilité des semi-conducteurs");
        $('select option:contains("Structural Mechanics")').html("Mécanique des structures");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("Simulation de systèmes, Sécurité et Jumeaux Numériques");
        $('select option:contains("Virtual Light Modeling")').html("Modélisation virtuelle de la lumière");
        $('select option:contains("Reliability Engineering Services")').html("Services d'ingénierie en fiabilité");
        $('select option:contains("Reliability Engineering")').html("Ingénierie de fiabilité");
        $('select option:contains("Photonics")').html("Photonique");
    }
    if ($("html[lang='it-IT']").length) {
        $('select option:contains("Cloud and Platform Services")').html("Servizi cloud e piattaforme");
        $('select option:contains("Electromagnetics")').html("Elettromagnetismo");
        $('select option:contains("Fluid Dynamics")').html("Fluidodinamica");
        $('select option:contains("Materials")').html("Materiali");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("Safety Critical Embedded Software & Displays");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("Potenza, prestazioni e affidabilità dei semiconduttori");
        $('select option:contains("Structural Mechanics")').html("Meccanica strutturale");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("System Simulation, Safety & Digital Twins");
        $('select option:contains("Reliability Engineering Services")').html("Servizi di ingegneria dell'affidabilità");
        $('select option:contains("Reliability Engineering")').html("Ingegneria dell'affidabilità");
        $('select option:contains("Photonics")').html("Fotonica");
    }
    if ($("html[lang='ja-JP']").length) {
        $('select option:contains("3D Design Exploration")').html("3Dデザイン探索");
        $('select option:contains("Cloud and Platform Services")').html("クラウドおよびプラットフォームサービス");
        $('select option:contains("Electromagnetics")').html("電磁界");
        $('select option:contains("Fluid Dynamics")').html("流体力学");
        $('select option:contains("Materials")').html("材料");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("セーフティクリティカルな組込みソフトウェアおよびディスプレイ");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("半導体の電力、パフォーマンスと信頼性");
        $('select option:contains("Structural Mechanics")').html("構造力学");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("システムシミュレーション、安全性、デジタルツイン");
        $('select option:contains("Virtual Light Modeling")').html("仮想光源モデリング");
        $('select option:contains("Reliability Engineering Services")').html("信頼性エンジニアリングサービス");
        $('select option:contains("Reliability Engineering")').html("信頼性エンジニアリング");
        $('select option:contains("Photonics")').html("フォトニクス");
    }
    if ($("html[lang='ko-KR']").length) {
        $('select option:contains("3D Design Exploration")').html("3D 설계 탐색");
        $('select option:contains("Cloud and Platform Services")').html("클라우드 및 플랫폼 서비스");
        $('select option:contains("Electromagnetics")').html("전자기");
        $('select option:contains("Fluid Dynamics")').html("유체 역학");
        $('select option:contains("Materials")').html("재료");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("반도체 전력, 성능 및 안정성");
        $('select option:contains("Structural Mechanics")').html("구조 역학");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("시스템 시뮬레이션, 안전 및 디지털 트윈");
        $('select option:contains("Virtual Light Modeling")').html("가상 조명 모델링");
        $('select option:contains("Reliability Engineering Services")').html("신뢰성 엔지니어링 서비스");
        $('select option:contains("Reliability Engineering")').html("신뢰성 공학");
        $('select option:contains("Photonics")').html("포토닉스");
    }
    if ($("html[lang='zh-CN']").length) {
        $('select option:contains("3D Design Exploration")').html("3D设计");
        $('select option:contains("Cloud and Platform Services")').html("云端和平台服务");
        $('select option:contains("Electromagnetics")').html("电磁学");
        $('select option:contains("Fluid Dynamics")').html("流体动力学");
        $('select option:contains("Materials")').html("材料");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("安全关键型嵌入式软件和显示器");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("半导体功率、性能和可靠性");
        $('select option:contains("Structural Mechanics")').html("结构力学");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("系统仿真、安全和数字孪生");
        $('select option:contains("Virtual Light Modeling")').html("虚拟光源建模");
        $('select option:contains("Reliability Engineering Services")').html("可靠性工程服务");
        $('select option:contains("Reliability Engineering")').html("可靠性工程");
        $('select option:contains("Photonics")').html("光电");
    }
    if ($("html[lang='zh-TW']").length) {
        $('select option:contains("3D Design Exploration")').html("3D 設計探索");
        $('select option:contains("Cloud and Platform Services")').html("雲端與平台服務");
        $('select option:contains("Electromagnetics")').html("電磁學");
        $('select option:contains("Fluid Dynamics")').html("流體動力學");
        $('select option:contains("Materials")').html("材料");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("安全關鍵的嵌入式軟體和顯示");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("半導體功率、效能和可靠性");
        $('select option:contains("Structural Mechanics")').html("結構力學");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("系統模擬、安全和數位孿生");
        $('select option:contains("Virtual Light Modeling")').html("虛擬光線建模");
        $('select option:contains("Reliability Engineering Services")').html("可靠度工程服務");
        $('select option:contains("Reliability Engineering")').html("可靠度工程");
        $('select option:contains("Photonics")').html("光子學");
    }
    if ($("html[lang='de-DE']").length) {
        $('select option:contains("Cloud and Platform Services")').html("Cloud- und Plattformdienste");
        $('select option:contains("Electromagnetics")').html("Elektromagnetik");
        $('select option:contains("Fluid Dynamics")').html("Strömungsmechanik");
        $('select option:contains("Safety Critical Embedded Software and Displays")').html("Sicherheitskritische Embedded Software und Displays");
        $('select option:contains("Semiconductor Power, Performance and Reliability")').html("Halbleiterleistung, -performance und -zuverlässigkeit");
        $('select option:contains("Structural Mechanics")').html("Strukturmechanik");
        $('select option:contains("System Simulation, Safety and Digital Twins")').html("Systemsimulation, Sicherheit und digitale Zwillinge");
        $('select option:contains("Virtual Light Modeling")').html("Virtuelle Lichtmodellierung");
        $('select option:contains("Photonics")').html("Photonik");
    }
});

$(window).on("load", function () {
	setTimeout(function(){
	  //if pi parameter is present in URL, fetch the value and select that value in product interst drodpown
	  var urlParams = new URLSearchParams(window.location.search);
	  var pivalue=urlParams.get('pi');

      var map = new Map();
      map.set("3d-design-exploration", "3D Design Exploration");
      map.set("cloud-and-platform-services", "Cloud and Platform Services");
      map.set("electromagnetics", "Electromagnetics");
      map.set("fluid-dynamics", "Fluid Dynamics");
      map.set("lstc-ls-dyna", "LSTC LS-Dyna");
      map.set("materials", "Materials");
      map.set("safety-critical-embedded-software-and-displays", "Safety Critical Embedded Software and Displays");
      map.set("semiconductor-power,-performance-and-reliability", "Semiconductor Power, Performance and Reliability");
      map.set("structural-mechanics", "Structural Mechanics");
      map.set("system-simulation,-safety-and-digital-twins", "System Simulation, Safety and Digital Twins");
      map.set("virtual-light-modeling", "Virtual Light Modeling");
      map.set("reliability-engineering", "Reliability Engineering");
      map.set("reliability-engineering-services", "Reliability Engineering Services");
      map.set("photonics", "Photonics");
      map.set("digital-mission-engineering", "Digital Mission Engineering");
      map.set("optics", "Optics");

	  //if there's a PI value in URL, auto select the corresponding value in product interest dropdown
	  if(pivalue){
		  $('select[name="productInterest"]').val(map.get(pivalue)).trigger("click").find('option[value="+map.get(pivalue)+"]').prop({defaultSelected: true});
	  }

	  if(readCookie("theformparams")) {
		var cookie = document.cookie.match('(^|;)\\s*' + "theformparams" + '\\s*=\\s*([^;]+)').pop();
	  }

	  if (cookie != null) {
		var splitCookie = cookie.split("&");
		var formVals = [];
		var formKeys = [];
		for (var i = 0; i < splitCookie.length; i++) {
		  var fields = splitCookie[i].split("=");
		  formKeys.push(fields[0]);
		  formVals.push(fields[1]);
		}
		$(".ansys-form").each(function (e) {
		  for (var x = 0; x < formKeys.length; x++) {
			if(formVals[x] == "Viet Nam"){formVals[x] = "Vietnam";}
			var currentKey = formKeys[x];
			switch (true) {
			  case currentKey == "ProductInterest":
				currentKey = "productInterest";
				break;
			  case currentKey == "FirstNameCharacter":
				currentKey = "firstNameEnglish";
				break;
			  case currentKey == "LastNameCharacter":
				currentKey = "lastNameEnglish";
				break;
			  case currentKey == "Company":
				currentKey = "companySchool";
				break;
			  case currentKey == "Student":
				currentKey = "studentStatus";
				break;
			  case currentKey == "Country":
				currentKey = "countryRegion";
				break;
			  case currentKey == "State":
				currentKey = "stateProvince";
				break;
			  case currentKey == "Comments":
				currentKey = "comments";
				break;
			}
			var idName = currentKey.charAt(0).toLowerCase() + currentKey.slice(1);
			if ($(this).find('select[name='+idName+']').is("select")) {
			  //if pi parameter is present in URL, then auto-populate Product Interest dropdown value from URL instead of the cookie 
			  if(currentKey == "productInterest" && pivalue){
				$(this).find('select[name='+idName+']').val(map.get(pivalue));
			  }
			  else{
				$(this).find('select[name='+idName+']').val(formVals[x]);
			  }
			  
			  if(formVals[x] !== null && formVals[x] !== "") {
				if(currentKey == "productInterest" && pivalue){
				  $(this).find('select[name='+idName+']' + " option[value=\"" + map.get(pivalue) + "\"]").attr("selected", "selected");
				}
				else{
				  $(this).find('select[name='+idName+']' + " option[value=\"" + formVals[x].replace(/\%26/g, '&') + "\"]").attr("selected", "selected");
				}
					  
				$(this).find('select[name='+idName+']').addClass("prefilled");
				if($(this).closest(".ansys-form--gold").length > 0) {
				  $(this).find('select[name='+idName+']').parent().find("label").css({"transform": "translate(0px,-25px)", "font-size":"11px", "opacity":".5"});               
				}
				else {
				  $(this).find('select[name='+idName+']').parent().find("label").css({"transform": "translate(-8px,-25px)", "font-size":"11px"});
				}
			  }
			  var country = "";
			  if(idName == "countryRegion"){
				$(this).find('select[name='+idName+']').val(formVals[x]);
				$(this).find('select[name='+idName+']').attr("selected", "selected");
				$(this).find('select[name='+idName+']').trigger("change");
				if(formVals[x] !== null) {           
				  $(this).find('select[name='+idName+']').addClass("prefilled");
				  if($(this).closest(".ansys-form--gold").length > 0) {
					$(this).find('select[name='+idName+']').parent().find("label").css({"transform": "translate(0px,-25px)", "font-size":"11px", "opacity":".5"});               
				  }
				  else {
					$(this).find('select[name='+idName+']').parent().find("label").css({"transform": "translate(-8px,-25px)"});
				  }
				}
				if(typeof loadStates === "function"){
				  loadStates(formVals[x], $(this).closest("form").attr("id"));
				}
				if(typeof loadFormStates === "function"){
				  loadFormStates(formVals[x], document.getElementById($(this).attr("data-state-id")), '', $(this).closest("form").attr("id"));
				}
			  }
			}
			$(this).find('input[name='+idName+']').attr("value", formVals[x]).focus({
			  preventScroll: true,
			});
		  }
		});
	  }
	}, 500);
});