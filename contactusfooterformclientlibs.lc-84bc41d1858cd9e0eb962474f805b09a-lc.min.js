$(document).ready(function() {
		var footerformPathValue = $(".contactus-footer-form").attr("formPath");
		if ($(".contactus-footer-form").attr("data-form-path")) {
			footerformPathValue = $(".contactus-footer-form").attr("data-form-path");
		}
    
		var locale = (footerformPathValue ? footerformPathValue.split("/").slice(4, 5).toString() : "");

    if(locale == 'ko-kr') {
       $("input[name=lastNameEnglish],input[name=firstNameEnglish],input[name=cellPhone],input[name=department],select[name=industry]").parent().parent().removeClass('hidden');
	  }
	  if(locale == 'ja-jp') {
       $("input[name=lastNameEnglish],input[name=firstNameEnglish],select[name=purchaseAuthority],input[name=caeSoftware],select[name=purchaseTimeframe],.contactus-footer-form input[name=department],.contactus-productsales-form input[name=department],.contactus-training-form input[name=department],select[name=industry]").parent().parent().removeClass('hidden');
	  }  
	  if(locale == 'zh-cn') {
       $("input[name=lastNameEnglish],input[name=firstNameEnglish],input[name=cellPhone]").parent().parent().removeClass('hidden');
			 $('.ansys-form select[name="productInterest"]').find('option[value="Digital Mission Engineering"]').remove();
	  }

	$(window).on("load", function(){
		if(locale != 'ko-kr'){
			$('.contactus-footer-form input[name=department]').removeAttr("required");
			if($('.contactus-footer-form input[name=department]').parent().find("label").text().indexOf(" *")> -1){
				$('.contactus-footer-form input[name=department]').parent().find("label").text($('.contactus-footer-form input[name=department]').parent().find("label").text().split(" *")[0]);
			}
     	}
	});

    function uuidv4() {
        return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>
             (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
        );
    };

    
    $(".contactus-footer-form").on("submit", function(e) {
		thecurrentform = e.target;
        e.preventDefault();
        grecaptcha.reset();
        grecaptcha.execute(eval("'"+$(thecurrentform).find(".recaptcha").attr("data-sitekey")+"'"), {
            action: 'submit'
        }).then(function(token) {
            recaptchaResponseToken = token;
            var $theform = $(thecurrentform);
            var failure = function(err) {
                alert("Unable to retrive data " + err);
            };
			//Get the user-defined values
			var formPath = $(thecurrentform).attr("formPath");
			if ($(thecurrentform).attr("data-form-path")) {
				formPath = $(thecurrentform).attr("data-form-path");
			}
			var salutation = $(thecurrentform).find('select[name=salutation]').val();
			var firstName = $(thecurrentform).find('input[name=firstName]').val();
			var firstNameEnglish = $(thecurrentform).find('input[name=firstNameEnglish]').val();
			var lastName = $(thecurrentform).find('input[name=lastName]').val();
			var lastNameEnglish = $(thecurrentform).find('input[name=lastNameEnglish]').val();
			var email = $(thecurrentform).find('input[name=email]').val();
			var phone = $(thecurrentform).find('input[name=phone]').val();
			var countryRegion = $(thecurrentform).find('select[name=countryRegion]').val();
			var country = countryRegion!=undefined ? countryRegion : "";
			country = country == "Vietnam" ? "Viet Nam" : country ;
			var stateProvince = $(thecurrentform).find('select[name=stateProvince]').val();
			var state = stateProvince!=undefined ? stateProvince : "";
			state = state == "Odisha (Orissa)" ? "Orissa" : state;
			var city = $(thecurrentform).find('input[name=city]').val();
			var postalCode = $(thecurrentform).find('input[name=postalCode]').val();
			var companySchool = $(thecurrentform).find('input[name=companySchool]').val();
			var studentStatus = $(thecurrentform).find('select[name=studentStatus]').val() != undefined ? $(thecurrentform).find('select[name=studentStatus]').val() : "";
			var jobLevel = $(thecurrentform).find('select[name=jobLevel]').val();
			var productInterest = $(thecurrentform).find('select[name=productInterest]').val();
			var productAssignmentTagArray =  $('.productInterestAssignment').attr('data-value') != undefined ? $('.productInterestAssignment').attr('data-value').split(',') : "" ;
			var formProductAssignment;
			for(var i = 0; i < productAssignmentTagArray.length; i++) {
					if (productAssignmentTagArray[i].startsWith("ansys:forms")) {
						formProductAssignment = productAssignmentTagArray[i];
						break;
						}
			}
			var productInterestAssignment = formProductAssignment != undefined ? formProductAssignment : "";
			var comments = $(thecurrentform).find('textarea[name=comments]').val();
			var receiveUpdatesYes;
			if ( $(thecurrentform).find('#receiveUpdatesYes').is(':checked') ) {
					receiveUpdatesYes = $(thecurrentform).find('#receiveUpdatesYes').is(':checked');
			} else {
					receiveUpdatesYes = null;
			}                     
			var utm_campaign = $(thecurrentform).find('input[name=utm_campaign]').val();
			var gclid = $(thecurrentform).find('input[name=gclid]').val();
			var utm_content = $(thecurrentform).find('input[name=utm_content]').val();
			var utm_medium = $(thecurrentform).find('input[name=utm_medium]').val();
			var utm_source = $(thecurrentform).find('input[name=utm_source]').val();
			var utm_term = $(thecurrentform).find('input[name=utm_term]').val();
			var campaignID = $(thecurrentform).find('input[name=campaignID]').val();
			var campaignID2 = $(thecurrentform).find('input[name=campaignID2]').val();
			var primaryCampaign = campaignID != "" ? campaignID : campaignID2;
			var qualificationType = $(thecurrentform).find('input[name=qualificationType]').val();
			var leadSource = $(thecurrentform).find('input[name=leadSource]').val();
			var leadSourceDetail = $(thecurrentform).find('input[name=leadSourceDetail]').val();
			var typeOfInquiry = $(thecurrentform).find('input[name=typeOfInquiry]').val();
			var webpageActivity = $(thecurrentform).find('input[name=webpageActivity]').val();
			var webpage = $(thecurrentform).find('input[name=webpage]').val()
			var caeSoftware = $(thecurrentform).find('input[name=caeSoftware]').val();
			var cellPhone = $(thecurrentform).find('input[name=cellPhone]').val();
			var department = $(thecurrentform).find('input[name=department]').val();
			var purchaseAuthority = $(thecurrentform).find('select[name=purchaseAuthority]').val();
			var purchaseTimeframe = $(thecurrentform).find('select[name=purchaseTimeframe]').val();
			var optinSource = $(thecurrentform).find('input[name=optinSource]').val();
			var industry = $(thecurrentform).find('select[name=industry]').val();
			var memberStatus = $(thecurrentform).find('input[name=memberStatus]').val();
			var recaptchas = document.querySelectorAll('div[class=g-recaptcha]');
			var currentPageURL = $(location).attr('href');
			var adobeID;
			if(window._satellite != undefined) {
				adobeID = _satellite.getVar('Core: Experience Cloud ID (ECID)');
			}
			
			if (recaptchaResponseToken != null) {
				$(thecurrentform).find(".form-group.recaptcha .error-message-box.error").html("");
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').addClass('button-inactive');
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').parent().css({
					"position": "relative",
					"max-width": $(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').innerWidth()
				});
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').css({
					"position": "relative",
					"max-width": $(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').innerWidth(),
					"width": $(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').innerWidth(),
					"height": $(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').innerHeight()
				});
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').text("").empty();
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit:after').css({
					"content": "none"
				});
				$(thecurrentform).find('.form-submit-border .btn.btn-ansys-submit').blur();

							$("#contactUsFormSubmit").append('<img class="form-loading-spinner" src="https://www.ansys.com/content/dam/system/loading-small.gif" style="width: 45px;position: relative;top: -14px;">');

							setTimeout(function() {
								//Use JQuery AJAX request to post data to a Sling Servlet
								$.ajax({
									type: 'POST',
									async: false,
									url: formPath + '.form.json',
									data: 'recaptchaResponseToken=' + recaptchaResponseToken,
									success: function(formData) {
										var ifrm = document.createElement('iframe');
										var ifrmId = 'ifrm-' + uuidv4();
										ifrm.setAttribute("style", "height:1px;width:1px;border:0");
										ifrm.setAttribute('id', ifrmId); // assign an id
										ifrm.setAttribute('frameborder', '0');
										ifrm.setAttribute('scrolling', 'no');
										$theform.hide(); // to place at end of document
										//document.body.appendChild(ifrm); // to place at end of document
										// assign url
										var utm_Tracking_Parameters = 'utm_campaign%3D'+utm_campaign+'%26utm_source%3D'+utm_source+'%26utm_medium%3D'+utm_medium+'%26utm_content%3D'+utm_content+'%26campaignid%3D'+campaignID+'%26utm_term%3D'+utm_term+'%26GCLID%3D'+gclid;									
										var pardotURL = formData.iframeSrcUrl +
											"?Email=" + email +
											"&FirstName=" + firstName.replace(/\&/g, '%26') +
											"&FirstNameCharacter=" + (firstNameEnglish ? firstNameEnglish.replace(/\&/g, '%26') : "") +
											"&LastName=" + lastName.replace(/\&/g, '%26') +
											"&LastNameCharacter=" + (lastNameEnglish ? lastNameEnglish.replace(/\&/g, '%26') : "") +
											"&Salutation=" + salutation +
											"&Company=" + companySchool.replace(/\&/g, '%26') +
											"&Phone=" + phone +
											"&Country=" + country.replace(/\&/g, '%26') +
											"&State=" + state.replace(/\&/g, '%26') +
											"&City=" + city.replace(/\&/g, '%26') +
											"&PostalCode=" + postalCode +
											"&JobLevel=" + jobLevel +
											"&Student=" + studentStatus +
											"&Optin=" + receiveUpdatesYes +
											"&ProductInterest=" + productInterest +
											"&ProductInterestAssignment=" + formData.productInterestAssignment +
											"&utm_campaign=" + utm_campaign +
											"&GCLID="+ gclid +
											"&utm_content=" + utm_content +
											"&utm_source=" + utm_source +
											"&utm_medium=" + utm_medium +
											"&utm_term=" + utm_term +
											"&UTM_Tracking_Parameters= "+ utm_Tracking_Parameters +
											"&CampaignID=" + campaignID +
											"&CampaignID2=" + campaignID2 +
											"&PrimaryCampaign=" + primaryCampaign +
											"&QualificationType=" + qualificationType +
											"&Source=" + leadSource +
											"&LeadSourceDetail=" + leadSourceDetail +
											"&TypeOfInquiry=" + typeOfInquiry +
											"&WebPageActivity=" + webpageActivity +
											"&WebPage=" + webpage +
											"&CAESoftware=" + caeSoftware +
											"&CellPhone=" + cellPhone +
											"&Department=" + department +
											"&PurchaseAuthority=" + purchaseAuthority +
											"&PurchaseTimeframe=" + purchaseTimeframe +
											"&OptinSource=" + optinSource +
											"&Industry=" + industry +
											"&MemberStatus=" + memberStatus +
											"&CurrentPageURL=" + currentPageURL +
											"&AdditionalInfo=" + comments.replace(/\&/g, '%26') +
											"&adobeID=" + adobeID;
										ifrm.setAttribute('thesrc', pardotURL);
										setTimeout(function() {
											$("#" + ifrmId).attr("src", $("#" + ifrmId).attr("thesrc")); //to prevent iframe from firing twice
										}, 100);
										$(".cmp-text.rte").parent().hide();
										$(".message-wrapper__thank-you").show().append(ifrm).insertAfter($theform);
										$(':input')
											.not(':button, :submit, :reset, :hidden')
											.val('')
											.removeAttr('checked')
											.removeAttr('selected');
										
										if(window.digitalData != undefined) {
											window.digitalData.events.eventName = "footerContactFormSubmission";
											window.digitalData.events.eventCategory = "Form Submission";
											window.digitalData.events.eventAction = "success";
											window.digitalData.visitor.country = country;
											window.digitalData.visitor.postalCode = postalCode;
											window.digitalData.visitor.visitorType = jobLevel;
											window.digitalData.visitor.product = productInterest;
											window.digitalData.forms.submitted = "True";
											if(leadSourceDetail == "Asset Download") {
												window.digitalData.forms.type = leadSourceDetail + " " + webpageActivity;
												sessionStorage.setItem("theformtype", leadSourceDetail);
											}
											else {
												window.digitalData.forms.type = webpageActivity;
												sessionStorage.setItem("theformtype", webpageActivity);
											}
											sessionStorage.setItem("theemail", email);
										}
									},
								   error : function () {
									} 
								});
							}, 500);
						} 
						
						eraseCookie("theformparams");
						var theformparamsaggregate = "";
						theformparamsaggregate = "Email=" + email +
						"&FirstName=" + firstName +
						"&FirstNameCharacter=" + firstNameEnglish +
						"&LastName=" + lastName +
						"&LastNameCharacter=" + lastNameEnglish + 
						"&Company=" + companySchool +
						"&Student=" + studentStatus +
						"&Phone=" + phone +
						"&Country=" + country.replace(/\&/g, '%26') +
						"&State=" + state.replace(/\&/g, '%26') +
						"&City=" + city +
						"&PostalCode=" + postalCode +
						"&JobLevel=" + jobLevel;
						createCookie("theformparams", theformparamsaggregate);
					});
			 });
		});
var recaptchachecked;

function recaptchaCallback() {
    recaptchachecked = true;
};

$(document).ready(function() {

    // on load trigger Product Sales Form
    $('.contactus-form-selector').val('sales').trigger('change');

    // on load hide State Field Dropdown
    $('.contactus-footer-form .ddlStateList').parent().hide();

    $(".contactus-footer-form").each(function() {   
        if(countryStatesObj["defaultMarketing"][0].defaultMarketingText != "") {
            $(this).find(".mktgmsg").removeClass("d-none").addClass("d-block");
            $(this).find(".mktgmsg label").html(extractxtFooterIso(countryStatesObj["defaultMarketing"][0],"defaultMarketingText"));
        }
        else {
			$(this).find(".mktgmsg").removeClass("d-block").addClass("d-none");
        }        
    });

    var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
    var isIEEdge = /Edge/.test(navigator.userAgent);
    var is_safari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (isIE11 || navigator.userAgent.indexOf('MSIE') !== -1) {
        if ($(".contactus-footer-form .Captchafield").length > 0) {
            $(".contactus-footer-form .Captchafield").detach();
            $(".contactus-footer-form .form-submit-border.text-left").css({
                "margin-top": "40px"
            });
        }
    }


    $('.contactus-footer-form.ansys-form [type=text], .contactus-footer-form.ansys-form [type=email], .contactus-footer-form.ansys-form [type=number], .contactus-footer-form.ansys-form textarea, .contactus-footer-form.ansys-form select').each(function() {
        $(this).parent().addClass("theinput");

        if ($.trim($(this).val()) == '') {
            $(this).addClass("theblank");
        } else if (!$(this).hasClass("theblank")) {
            //$(this).parent().find("label").removeAttr('style').css({
               // "font-size": "16px",
               // "transform": "translate(0,0)",
               // "color": "#313131"
           // });
        }

        $(this).on('focus', function() {
            if ($.trim($(this).val()) == '') {
                $(this).addClass("theblank");
                $(this).parent().find("label").addClass('active').removeClass('required');
            } else {
                $(this).removeClass("theblank");
                $(this).parent().find("label").removeClass('active').removeClass('required');
            }
        });

        $(this).on('blur', function(event) {
            if ($.trim($(this).val()) == '') {
                $(this).addClass("theblank");
                $(this).parent().find("label").addClass('required').removeClass('active');
            } else {
                if($(this).closest('select')) {
					$(this).attr("value",$(this).val());
                }
                $(this).removeClass("theblank");
                $(this).parent().find("label").removeClass('required').removeClass('active');

            }

            //Field validation    
            var ele = $(this);
            var message = "";
            if (ele.attr("data-val-multiregex-pattern") != "") {
                ele.prop('pattern', ele.attr("data-val-multiregex-pattern"));
            }
            if (ele.attr("data-val-length-max") != "") {
                ele.prop('maxlength', ele.attr("data-val-length-max"));
            }
            if (ele.attr("data-val-length-min") != "") {
                ele.prop('minLength', ele.attr("data-val-length-min"));
            }
            var res = event.target.checkValidity();
            if (res == false) {
                if (event.target.validity.valueMissing) {
                    if ($(event.target).parent().hasClass("ddlStateList")) {
                        message = "The State field is required.";
                    } else {
                        message = ele.attr("data-val-required");
                    }
                } else if (event.target.validity.patternMismatch) {
                    message = ele.attr("data-val-multiregex");
					ele.next('label').addClass('invalid');
                } else if (event.target.validity.tooLong) {
                    message = ele.attr("data-val-length");
                } else if (event.target.validity.tooShort) {
                    message = ele.attr("data-val-length");
                } else if (event.target.validity.typeMismatch) {
                    message = ele.attr("data-val-length");
                }
                //console.log("Message : " + message);
                if ($(this).parent().hasClass("theinput")) {
                    $(this).parent().find('.error-message-box').show().html(message);
                }
            } else {
                if ($(event.target).parent().hasClass("ddlStateList")) {
                    $(event.target).parent().find('span:first').hide();
                } else {
                    $(this).parent().find('span:first').empty();
                }
            }
        });
    });


    $('.contactus-footer-form .CommentsBox').each(function () {

        $(this).append("<span class='remainingC'></span>");

        var $myTextarea = $(this).find("textarea")
        var $myRemainingC = $(this).find(".remainingC")
        $myTextarea.each(function (index) {
            $(this).on("paste", function (event) {
                setTimeout(function () {
                    var thetextareatext =  $myTextarea.eq(index).val().split("");
                    while (thetextareatext.length >  $myTextarea.eq(index).attr("data-val-length-max")) {
                        thetextareatext.pop();
                    }
                    $myTextarea.eq(index).val(thetextareatext.join(""));
                }, 0)
            })
        })
        $myTextarea.on("load focus keypress keyup blur", function () {
            if (this.value.length >= 1 && this.value.length <= $(this).attr("data-val-length-max")) {
            $myRemainingC.show().html(($(this).attr("data-val-length-max") - this.value.length) + " of " + $(this).attr("data-val-length-max"));
            }
            else if (this.value.length >= $(this).attr("data-val-length-max")) {
            $myRemainingC.show().html("0 of " + ($(this).attr("data-val-length-max")));
            }
            else {
            $myRemainingC.hide();
            }
            if (this.value.length >= $(this).attr("data-val-length-max")) {
                return false;
            }
        });
        $myRemainingC.slice(1).remove(); //remove duplicate
    });
    

    // Set HTML5 required fields
    $('.contactus-footer-form .required-field').each(function() {
        $(this).find('input').prop('required', true);
        $(this).find('select').prop('required', true);
        $('.ddlRequired').find('select').prop('required', true);
    });

    // Add 'keySelected' classname to label when key press selection is used for selection dropdown
    $(".contactus-footer-form .custom-select").on("change", function() {
      $(this).next('label').addClass('keySelected')
    });

    // Force clear form fields to fix FF retaining form data after reload
    document.forms[0].reset();

    // Contact Footer Form Fields - Labels exceeding 1 line
    $(".contactus-footer-form .form-control").each(function() {
        var thislabelH = $(this).next().innerHeight();
        if(thislabelH > 30){
          $(this).next().addClass("label-md");
        }
        if(thislabelH > 50){
          $(this).next().addClass("label-lg");
        }
    });

    // Change column layout for certain form fields in German and French locales
    $(".contactus-footer-form").each(function() {
        if ($("html[lang='de-DE']").length) {
            var companySchoolFooter = $(this).find("input[name*='companySchool']").parent().parent()
            companySchoolFooter.removeClass('col-md-4').addClass('col-md-8');
        }
        if ($("html[lang='fr-FR']").length) {
            var studentFooter = $(this).find("select[name*='studentStatus']").parent().parent()
            studentFooter.removeClass('col-md-4').addClass('col-md-8');
        }
    });
	setTimeout(function(){
        var thecountrystateset = false;
        if(readCookie("theformparams")) { 
            initFooterDropdowns();
            thecountrystateset = true; 
        }
        else {
            $(".ansys-form input, .ansys-form textarea, .ansys-form select").one('focus', function(){ 
                if(thecountrystateset == false) {
                    initFooterDropdowns();
                    thecountrystateset = true;
                } 
            });
        }
    }, 50);    
});

function initFooterDropdowns() {
    $(".contactus-footer-form").each(function() {

        let dropdownContactCountry = getSelectForTargetForm(document.getElementById($(this).attr("id")), 'countryRegion');
        resetDropdown(dropdownContactCountry, $(this).find("#countryRegion option:first").text());
        loadDropdown(dropdownContactCountry, countryStatesObj["countries"]);
        resetDropdown(getSelectForTargetForm(document.getElementById($(this).attr("id")), 'stateProvince'), $(this).find("#stateProvince option:first").text());
        $(this).find(".ddlCountryList select").on("change", function() {
            loadStates(this, $(this).closest("form").attr("id"));
        });

        if(countryStatesObj["defaultMarketing"][0].defaultMarketingText != "") {
            $(this).find(".mktgmsg").removeClass("d-none").addClass("d-block");
            $(this).find(".mktgmsg label").html(extractxtFooterIso(countryStatesObj["defaultMarketing"][0],"defaultMarketingText"));
        }
        else {
			$(this).find(".mktgmsg").removeClass("d-block").addClass("d-none");
        }
        if(countryStatesObj["defaultOptin"][0].defaultOptinText != "") {
			$(this).find(".optinmsg label").html(extractxtFooterIso(countryStatesObj["defaultOptin"][0],"defaultOptinText"));
        }
    });
}

function loadStates(country, form) {
    var selCode = country.value;
    let elem = document.getElementById(form);
    if (elem) {
      let dropdownState = getSelectForTargetForm(elem, 'stateProvince');

      for (let n = 0; n < countryStatesObj["countries"].length; n++) {
        if (countryStatesObj["countries"][n].code == selCode) {
            if(countryStatesObj["defaultOptin"][0].defaultOptinText != "" || countryStatesObj["defaultMarketing"][0].defaultMarketingText != "") {
				optinmarketingFooterMsg(countryStatesObj["countries"][n], form);
            }

            var statesObj = countryStatesObj["countries"][n].states;

            resetDropdown(dropdownState, $(eval("'#" + form + "'")).find("#stateProvince option:first").text());
            loadDropdown(dropdownState, statesObj);
        } // selCode
      } // n
    } // elem
}

function extractxtFooterIso(thecountry,themsgtype) {
    return(thecountry[themsgtype].split($("html").attr("lang").toLowerCase() + ":")[1].split("|")[0]);

}

function optinmarketingFooterMsg(thecountry, form){
	if(typeof thecountry.marketingText !== "undefined" && thecountry.marketingText !== "") {
		$(eval("'#" + form + "'")).find(".mktgmsg").removeClass("d-none").addClass("d-block");
    	$(eval("'#" + form + "'")).find(".mktgmsg label").html(extractxtFooterIso(thecountry,"marketingText"));
    }
    else if(typeof thecountry.marketingText !== "undefined" && thecountry.marketingText == "") {
		$(eval("'#" + form + "'")).find(".mktgmsg").removeClass("d-block").addClass("d-none");
    	$(eval("'#" + form + "'")).find(".mktgmsg label").html(extractxtFooterIso(thecountry,"marketingText"));
    }
    else {
		$(eval("'#" + form + "'")).find(".mktgmsg").removeClass("d-none").addClass("d-block");
        $(eval("'#" + form + "'")).find(".mktgmsg label").html(extractxtFooterIso(countryStatesObj["defaultMarketing"][0],"defaultMarketingText"));
    }

    if(typeof thecountry.optinText != "undefined" && thecountry.optinText !== "" && thecountry.optinText !== " ") {
		$(eval("'#" + form + "'")).find(".optinmsg").removeClass("d-none").addClass("d-block");
		$(eval("'#" + form + "'")).find(".optinmsg label").html(extractxtFooterIso(thecountry,"optinText"));
	}
    else if(typeof thecountry.optinText != "undefined" && thecountry.optinText == " ") {
		$(eval("'#" + form + "'")).find(".optinmsg").removeClass("d-block").addClass("d-none");
	}
	else {
		$(eval("'#" + form + "'")).find(".optinmsg").removeClass("d-none").addClass("d-block");
		$(eval("'#" + form + "'")).find(".optinmsg label").html(extractxtFooterIso(countryStatesObj["defaultOptin"][0],"defaultOptinText"));
	}

    if(!$(eval("'#" + form + "'")).find(".optinmsg").hasClass("d-none") && !$(eval("'#" + form + "'")).find(".mktgmsg").hasClass("d-none")) {
		$(eval("'#" + form + "'")).find(".mktgmsg hr").removeClass("d-none").addClass("d-block");
    }
    else {
		$(eval("'#" + form + "'")).find(".mktgmsg hr").removeClass("d-block").addClass("d-none");
    }
}

function resetDropdown(dropdown, defaultValue) {
    dropdown.length = 0;

    let defaultOption = document.createElement('option');
    defaultOption.text = defaultValue;
    defaultOption.value = '';
    dropdown.add(defaultOption);
    dropdown.selectedIndex = 0;
}

function loadDropdown(dropdown, dataObj) {
    let option;
    for (let i = 0; i < dataObj.length; i++) {
        option = document.createElement('option');
        option.text = dataObj[i].name;
        option.value = dataObj[i].code;
        dropdown.add(option);
    }
    if (dataObj.length > 0) {
        dropdown.parentElement.parentElement.style.display = "block";
        dropdown.parentElement.classList.add("required-field");
        dropdown.setAttribute("required", true);
    } else {
        dropdown.parentElement.classList.remove("required-field");
        dropdown.parentElement.parentElement.style.display = "none";
        dropdown.removeAttribute("required", false);
    }
}

function getSelectForTargetForm(targetForm, elementName) {
    let selectObj;
    var elementType = 'SELECT'

    for (i = 0; i < targetForm.length; i++) {
        if (targetForm.elements[i].tagName == elementType && targetForm.elements[i].name == elementName) {
            return targetForm.elements[i];
        }
    }

    return '';
}
